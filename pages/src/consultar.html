<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bienvenido - Seguros Bolívar</title>
    <link href="https://cdn.jsdelivr.net/npm/boxicons/css/boxicons.min.css" rel="stylesheet"> <!-- Incluye Boxicons -->
    <!-- Add Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Add Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
    <style>
        :root {
            --black-text:#313131;
            --Green-text:#02310a;
            --primary-green: #008c45;
            --light-green: #9DC45F;
            --white: #ffffff;
            --gray-light: #f4f4f4;
            --yellow-primary: #c0c23d;
            
        }

        /* Estilos generales */
        body {
            margin: 0;
            padding: 0;
            min-height: 100vh;
            font-family: 'Arial', sans-serif;
            display: flex;
            flex-direction: column;
            background-color: var(--white);
        }

        .logo-container {
            position: flex;
            z-index: 1;
            width: 230px;
            height: 60px;
            background-size: contain;
            background-position: center;
        }

        /* Estilos del navbar */
        .navbar {
            background: var(--light-green);
            padding: 0.5rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: relative;
        }
        /* adornos en nav y sidebar */

        .navbar::before {
            box-shadow: 2px 0px 10px rgba(0, 0, 0, 0.1);
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            width: 33%;
            height: 130%;
            background: var(--primary-green);
            border-radius: 0 0 100% 0;
        }
        .sidebar::after {
            box-shadow: 2px 0px 10px rgba(0, 0, 0, 0.1);
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            width: 173%;
            height: 21%;
            background: var(--primary-green);
            border-radius: 0 0 101% 0;
        }

        .nav-right {
            display: flex;
            align-items: center;
            gap: 1rem;
            color: var(--white);
        }

        .ingresa-text {
            font-size: 1.2rem;
            text-decoration: none;
        }

        .nav-button {
            padding: 0.5rem 1rem;
            color: #0b633a;
            /* text-decoration: underline; */
            background-color: transparent;
            border: 1px solid rgb(0, 78, 7);
            border-radius: 4px;
            cursor: pointer;
            font-size: 1rem;
            transition: background-color 0.3s, color 0.3s;
        }

        .nav-button:hover {
            background-color: var(--primary-green);
            color: var(--white);
        }

        /* Estilos del contenedor principal */
        .main-container {
            padding: 3rem;
            max-width: 1200px;
            margin: 2rem auto;
            background-color: var(--gray-light);
            border-radius: 8px;
            box-shadow: 0px 4px 20px rgba(0, 0, 0, 0.1);
        }

        .welcome-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1.5rem;
        }

        .welcome-header h2 {
            font-size: 2.5rem;
            color: var(--primary-green);
        }

        .user-indicator {
            font-size: 1.1rem;
            color: #666;
        }

        /* Estilos del grid de opciones */
        .options-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            padding: 20px;
            max-width: 1000px;
            margin: 0 auto;
            border: 1px solid #ccc;
            background-color: var(--white);
            border-radius: 8px;
            box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.05);
        }

        .option-button {
            background-color: var(--white);
            border: 1px solid #ddd;
            padding: 20px;
            text-align: center;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            min-height: 100px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: #333;
            text-decoration: none;
        }

        .option-button:hover {
            background-color: #f1f1f1;
            transform: translateY(-2px);
        }

        .option-button small {
            font-size: 0.9rem;
            color: #888;
        }

        .footer {
            background-color: var(--primary-green);
            padding: 1rem;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 2rem;
        }

        .footer .copyright {
            color: var(--white);
            font-size: 0.9rem;
        }

        .footer-logos {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-left: 2rem;
        }

        .footer-logo {
            height: 30px;
            width: auto;
        }

        /* Estilos del logo de AppMetrics */
        .appmetrics-logo {
            width: 150px;
            height: 150px;
            background-color: #D3D3D3;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 2rem;
        }

        .appmetrics-logo img {
            width: 80%;
            height: auto;
        }
        .filters-section {
        background-color: #f8f9fa;
        padding: 1rem;
        border-radius: 8px;
        margin-bottom: 1rem;
    }
    
    .table-container {
        background-color: white;
        padding: 1rem;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .table thead th {
        background-color: #008948;
        color: white;
        cursor: pointer;
    }

    .pagination .page-item.active .page-link {
        background-color: #008948;
        border-color: #008948;
    }

    .page-link {
        color: #008948;
    }

    .search-bar {
        max-width: 300px;
    }
    /* nav-sidebar */
    nav .logo2{
            position: relative;
            display:flex;
            align-items: center;
            margin: 10px 27px;
        }
        nav .logo{
            position: relative;
            display:flex;
            align-items: center;
            margin: 2px 24px;
        }
        .logo .menu-icon,
        .logo2 .menu-icon,
        .logo .cart-icon {
            color: var(--yellow-primary);/*color del logo obvio*/
            font-size: 30px;/*modifica el tamaño del logo*/
            margin-right: 23px;/* separa al logo del titulo*/
            cursor:pointer;/*cuando se acerque el cursor al logo o icono sale el pointer*/
        
        }
        
        .logo .logoname,
        .logo2 .logoname{
            color:rgb(9, 9, 54);
            font-size: 24px;/*tamaño titulo*/
            font-weight: 0;/*separa supongo*/
        }
        
        nav .sidebar{
            position: fixed;
            top: 0;
            left: -100%;
            height: 100%;
            width: 260px;
            padding: 20px 0;
            background-color:var(--light-green);
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.1);/*sombras al navbar*/
            transition: all 0.5s ease;
            z-index: 1;
        
        
        }
        nav.open .sidebar{
            left:0;
        }
        .sidebar .sidebar-content,
         .sidebar-cart .sidebar-content{
            display: flex;
            height: 100%;
            flex-direction: column;
            justify-content: space-between;
            padding: 20px 10px; /*da espacio en el div a lo largo y anche a los iconos de la lista por el sidebar*/
        
         }
         .sidebar-content .list{
            list-style: none;
         }
         .list .nav-link{
            display: flex;
            align-items: center;
            margin-top: 17px;
            padding: 18px 20px;
            border-radius: 8px;/*redondear brodes*/
            background-color: transparent;
            text-decoration: none;/*quita decoraciones del texto por el link*/
         }
         .lists .nav-link:hover{
            background-color: var(--primary-green);
         }
         .lists .nav-link .icon{
            margin-right: 10px;
            color: var(--Green-text);
            font-weight: 400;
         }
     
        .lists .nav-link .link{
            font-size: 16px;
            color: var(--Green-text);
            font-weight: 400;
        }
        .lists .nav-link:hover .icon,
        .lists .nav-link:hover .link {
            color:var(--gray-light);
         }
         .overlay{
            position: fixed;
            top: 0;
            left: -100%;
            height: 1000vh;
            width: 200%;
            opacity: 0;
            background: rgb(0, 0, 0, 0.3);
            transition: all 0.4s ease;
            pointer-events: none;
        }
        nav.open .sidebar ~ .overlay{
            left: 260px;
            opacity: 1;
            pointer-events: auto;
        
        
        }
        /* paginacion */
        #pagination {
            display: flex;
            justify-content: center;
            list-style: none;
            padding: 0;
            margin: 20px 0;
        }

        .page-item {
            margin: 0 5px;
        }

        .page-item a {
            padding: 8px 15px;
            border-radius: 5px;
            text-decoration: none;
            color: #007bff;
            border: 1px solid #ddd;
        }

        .page-item.active a {
            background-color: #007bff;
            color: white;
            border-color: #007bff;
        }

        .page-item.disabled a {
            color: #6c757d;
            border-color: #ddd;
            pointer-events: none;
        }

        .page-item a:hover {
            background-color: #f0f0f0;
        }

    </style>
</head>
<body>
    <nav class="navbar">

        <div class="logo-container logo2">
            <i class="bx bx-menu menu-icon"></i>
            <a href="#" onclick="loadIndexPage(); return false;">
                <img class="logo-container" src="https://i.ibb.co/5cWD2Fw/image.png" alt="Logo de Seguros Bolívar">
            </a>
        </div>
        <!-- <div>
            <a href="#" aria-label="Login"><button class="nav-button">Home</button></a>
            <a href="help.html" aria-label="Help"><button class="nav-button">Bandeja</button></a>
            <a href="#" aria-label="Login"><button class="nav-button">opciones</button></a>

        </div> -->
        <div class="nav-right">
            <span href="">Usuario</span>
            <a href="#" aria-label="Login"><button class="nav-button"><i class="bx bx-user"></i></button></a>
            <a href="help.html" aria-label="Help"><button class="nav-button"><i class="bx bx-question-mark"></i></button></a>
        </div>
        <!-- MENU HAMBUERGUESA -->
        <div class="sidebar">
            <div class="logo-container logo2">
                <i class='bx bx-menu menu-icon'></i>
                <img class="logo-container" src="https://i.ibb.co/5cWD2Fw/image.png" alt="Logo de Seguros Bolívar">
            </div>

            <div class="sidebar-content">
                <ul class="lists">
                    <li class="list">
                        <a onclick="loadIndexPage(); return false;" class="nav-link">
                            <i class='bx bx-home-alt icon'>
                                <span class="link">Home</span>
                            </i>
                        </a>
                    </li>
                    
                    <li class="list">
                        <a href="cuenta.html" class="nav-link"  type="button" data-bs-toggle="dropdown" aria-expanded="false">
                            <i class='bx bx-user-circle  icon'>                        
                            <span class="link">Cuenta</span>
                            </i>
                        </a>
                           
                    </li>
                    <li class="list">
                        <a href="help.html" class="nav-link">
                            <i class='bx bx-store icon' ></i>                                    
                                <span class="link">Ayuda</span>
                            </i>
                        </a>
                    </li>
                    <li class="list">
                        <a href="notificaciones.html" class="nav-link">
                            <i class='bx bx-bell icon' ></i>                                    
                                <span class="link">Notificaciones</span>
                            </i>
                        </a>
                    </li>                        

                </ul>
            </div>
        </div>
        <script>
            const navBar = document.querySelector("nav")
            menuBtns = document.querySelectorAll(".menu-icon")
            overlay = document.querySelector(".overlay")
    
            menuBtns.forEach((menuBtn) => {
                menuBtn.addEventListener("click", () => {
                    navBar.classList.toggle("open");
                });   
            });
    
            overlay.addEventLitener("click",() => {
                navBar.classList.remove("open");
            });
     
        </script>
    </nav>

        <main class="main-container">
            <div class="welcome-header">
                <h2>Cartas Descriptivas</h2>
            </div>

            
                <div class="Tabla-contenido">
                    <div class="filters-section">
                        <div class="row g-3 align-items-center">

                            <div class="col-auto">
                                <select class="form-select">
                                    <option selected>Filtrar por tipo</option>
                                    <option>Viceprecidencia</option>
                                    <option>Gerencia</option>
                                    <option>Cargo</option>
                                </select>
                            </div>
                            <div class="col-auto">
                                <select class="form-select">
                                    <option selected>Estado</option>
                                    <option>actualizado</option>
                                    <option>desactualizado</option>
                                </select>
                            </div>
                            <div class="col-auto">
                                <input type="date" class="form-control" id="fecha" required>
                            </div>
                            <div class="col-auto">
                                <div class="input-group search-bar">
                                    <input id="searchInput" type="text" class="form-control" placeholder="Buscar...">
                                    <button id="searchButton" class="btn btn-success">
                                        <i class="bi bi-search"></i>
                                    </button>
                                </div>
                            </div>
                            
                            
                        </div>
                    </div>
                
                    <div class="table-container">
                        <table class="table table-hover">
                            <thead>
                                <tr>
                                    <th scope="col">Cod Saghi</th>
                                    <th scope="col">Gerencia</th>
                                    <th scope="col">Vicepresidencia</th>
                                    <th scope="col">Cargo específico</th>
                                    <th scope="col">Estado</th>
                                    <th scope="col">Fecha actualización</th>
                                    <th scope="col">Acciones</th>
                                </tr>
                            </thead>
                            <tbody id="tableBody">
                                <!-- Los datos se insertarán aquí -->
                            </tbody>
                        </table>
                    
                        <nav aria-label="Page navigation">
                            <ul class="pagination justify-content-center" id="pagination">
                                <!-- La paginación se MUESTRA AQUI -->
                            </ul>
                        </nav>
                    <script>
                      let currentPage = 1;
                      const rowsPerPage = 12;
                      const maxPagesToShow = 10;
                      let allData = [];
                      let filteredData = []; // Agrega esta variable para almacenar los datos filtrados
                      
                      function loadData() {
                          google.script.run
                              .withSuccessHandler(processData)
                              .withFailureHandler(handleError)
                              .getData();
                      }
                      
                      document.getElementById('searchButton').addEventListener('click', performSearch);
                      
                      function performSearch() {
                          const searchInput = document.getElementById('searchInput').value.trim().toLowerCase();
                          // Filtramos los datos según la búsqueda
                          filteredData = allData.filter(row => {
                              return row.some(cell => String(cell || '').toLowerCase().includes(searchInput));
                          });
                      
                          // Actualizamos la paginación y mostramos la primera página de los resultados filtrados
                          updatePagination(filteredData);
                          displayPage(1, filteredData); // Aseguramos que estamos usando los datos filtrados
                      }
                      
                      function updatePagination(data) {
                          const totalPages = Math.ceil(data.length / rowsPerPage);
                          const pagination = document.getElementById('pagination');
                          pagination.innerHTML = '';
                      
                          // Botón Anterior
                          pagination.innerHTML += `
                              <li class="page-item ${currentPage === 1 ? 'disabled' : ''}">
                                  <a class="page-link" href="#" onclick="displayPage(${currentPage - 1}, filteredData); return false;">Anterior</a>
                              </li>
                          `;
                          
                          const startPage = Math.max(1, currentPage - Math.floor(maxPagesToShow / 2));
                          const endPage = Math.min(totalPages, startPage + maxPagesToShow - 1);
                          
                          // Páginas numeradas
                          for (let i = startPage; i <= endPage; i++) {
                              pagination.innerHTML += `
                                  <li class="page-item ${currentPage === i ? 'active' : ''}">
                                      <a class="page-link" href="#" onclick="displayPage(${i}, filteredData); return false;">${i}</a>
                                  </li>
                              `;
                          }
                      
                          // Botón Siguiente
                          pagination.innerHTML += `
                              <li class="page-item ${currentPage === totalPages ? 'disabled' : ''}">
                                  <a class="page-link" href="#" onclick="displayPage(${currentPage + 1}, filteredData); return false;">Siguiente</a>
                              </li>
                          `;
                      }
                      
                      function displayPage(pageNumber, data = filteredData) {
                          currentPage = pageNumber;
                          const tableBody = document.getElementById('tableBody');
                          tableBody.innerHTML = '';
                      
                          const start = (pageNumber - 1) * rowsPerPage;
                          const end = Math.min(start + rowsPerPage, data.length);
                      
                          for (let i = start; i < end; i++) {
                              const row = data[i];
                              const tr = document.createElement('tr');
                          
                              tr.innerHTML = `
                                  <td>${row[7] || ''}</td>
                                  <td>${row[1] || ''}</td>
                                  <td>${row[0] || ''}</td>
                                  <td>${row[2] || ''}</td>
                                  <td>
                                      <span class="badge ${isActualizado(row[5]) ? 'bg-success' : 'bg-danger'}">
                                          ${isActualizado(row[5]) ? 'Actualizado' : 'Desactualizado'}
                                      </span>
                                  </td>
                                  <td>${row[5] || ''}</td>
                                  <td>
                                      <a href="${row[4] || '#'}" target="_blank" class="btn btn-sm btn-outline-primary">
                                          <i class="bi bi-eye"></i>
                                      </a>
                                      <button class="btn btn-sm btn-outline-secondary">
                                          <i class="bx bx-archive-in"></i>
                                      </button>
                                  </td>
                              `;
                              
                              tableBody.appendChild(tr);
                          }
                      
                          updatePagination(data);
                      }
                      
                      function isActualizado(fecha) {
                          if (!fecha) return false;
                          const fechaActualizacion = new Date(fecha);
                          const ahora = new Date();
                          const diferenciaMeses = (ahora - fechaActualizacion) / (1000 * 60 * 60 * 24 * 30);
                          return diferenciaMeses <= 36; // Ajustar el rango de meses aquí
                      }
                      
                      function processData(sections) {
                          allData = [];
                          sections.forEach(section => {
                              section.data.forEach((row, index) => {
                                  if (index === 0) return; // Saltar la fila de encabezados
                                  allData.push(row);
                              });
                          });
                          filteredData = [...allData]; // Iniciar filteredData con los datos completos
                          updatePagination(filteredData);
                          displayPage(1, filteredData);
                      }
                      
                      function handleError(error) {
                          console.error('Error:', error);
                          document.getElementById('tableBody').innerHTML = `
                              <tr>
                                  <td colspan="7" class="text-center text-secondary">
                                      Error al cargar los datos: ${error.toString()}
                                  </td>
                              </tr>
                          `;
                      }
                      
                      window.onload = loadData;
                    </script>
                    <script>
                      // redireccionar al index y demas paginas
                      function loadIndexPage() {
                          google.script.run
                              .withSuccessHandler(function(htmlContent) {
                                  document.open();
                                  document.write(htmlContent);
                                  document.close();
                              })
                              .loadIndex();
                      }
                    </script>
                    </div>
                </div>
            
        </main>

    <footer class="footer">
        <p class="copyright">Grupo Bolivar S.A. Todos los derechos reservados</p>
        <div class="footer-logos">
            <img src="https://i.ibb.co/dppXC9X/image-1.png" alt="AppMetrics" class="footer-logo">
            <img src="https://i.ibb.co/5cWD2Fw/image.png" alt="Seguros Bolívar" class="footer-logo">
        </div>
    </footer>
</body>

<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js"></script>

</html>
